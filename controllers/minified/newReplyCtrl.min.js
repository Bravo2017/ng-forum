!function(e){function r(e,r,a,t,l,i,n,c){e.hide=function(){r.hide()},e.cancel=function(){r.cancel()},e.answer=function(e){r.hide(e)},e.submitNewReply=function(){e.currentAuthGet=a.ref().getAuth(),e.numRepliesAlready=c(a.ref().child("Replies").child(n.USERNAME+n.POST)),e.numRepliesAlready.$loaded(function(t){a.ref().child("UserAuthInfo").child(e.currentAuthGet.uid).on("value",function(r){e.userAvatar=r.val().Image,e.userName=r.val().Username,e.userEmail=r.val().Email});var n=a.ref().child("Replies").child(l.creatorUsername+l.postNum).push({replyCreatorUsername:e.userName,replyCreatorAvatar:e.userAvatar,replyCreatorEmail:e.userEmail,replyCreatorUID:e.currentAuthGet.uid,replyCreatorValue:e.reply.sentence,replyCreatorDate:Date.now(),Replynum:t.length,replyCreatorDateParsed:i.getTimeF(new Date(parseInt(Date.now()))),topicCreatorUsername:l.creatorUsername,topicCreatorUID:l.creatorUID,topicCreatorTitle:l.creatorTitle,topicCreatorAvatar:l.creatorAvatar,topicCreatorSince:l.timeSinceCreated});a.ref().child("Replies").child(l.creatorUsername+l.postNum).child(n.key()).update({pushKey:n.key()}),r.cancel()})}}var a=e.module("ForumApp");a.controller("newReplyCtrl",["$scope","$mdDialog","refService","currentAuth","replyService","timeService","$stateParams","$firebaseArray",r])}(angular);