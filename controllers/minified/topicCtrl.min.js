!function(e){function t(t,o,r,c,n,i,l,u,a,s,d,f,h,p,m){function v(e){var t=(new Date).getTime(),o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){var r=(t+Math.random()*e)%16|0;return t=Math.floor(t/16),("x"==o?r:3&r|8).toString(16)});return o}function T(){return t.didVote=!0,r.ref().child("Topics").once("value",function(e){e.forEach(function(e){var o=(e.key(),e.val());e.forEach(function(e){r.ref().child("Topics").child(o.pushKey).child("Vote").on("value",function(e){e.forEach(function(e){var o=(e.key(),e.val());o==x.uid&&(t.didVote=!0)})})})})}),1==t.didVote?"Voted":"NotVoted"}function y(e){return t.inside,t.checkBoxTrueCheck.$loaded(function(r){for(var c=0;c<r.length;c++)r[c].Postnum==o.POST&&(1==r[c].IsAcceptedAnwser&&r[c].AcceptedAnwserReplyNum==e.Replynum?(console.log(r[c].AcceptedAnwserReplyNum,e.Replynum),t.inside=!0):t.inside=!0)}),t.inside}function k(){t.decicor,t.dataNot=i(r.ref().child("Topics")),t.dataNot.$loaded(function(e){for(var c=0;c<e.length;c++)e[c].Postnum==o.POST&&r.ref().child("Topics").child(e[c].pushKey).on("value",function(e){1==e.val().IsAcceptedAnwser?t.decicor=!0:t.decicor=!1});return 1==t.decicor?"True":"Not"})}var x=r.ref().getAuth();t.currentAuthGet=r.ref().getAuth(),t.currentAuthGet||(x={uid:v(16)}),t.notAuthReplyTopic=function(){alertify.myAlert("Sorry , You must be logged in , to reply or have many feautres available.")},r.ref().child("Topics").on("value",function(e){e.forEach(function(e){var r=(e.key(),e.val());if(r.Postnum==o.POST){t.creatorAvatar=r.Avatar,t.creatorTitle=r.Title,t.creatorUID=r.UID,t.creatorUsername=r.Username,t.creatorValue=r.Value,t.creatorDate=r.DateCreated,t.creatorEmail=r.Email,t.timeSinceCreated=l.getTimeF(new Date(parseInt(t.creatorDate)));var c=new Date(parseInt(t.creatorDate));t.creatorDateParsed=l.getTimeF(c)}}),t.actualReplyUser=f(r.ref().child("UserAuthInfo").child(t.creatorUID))}),t.views=f(r.ref().child("Topics")),r.ref().child("Topics").once("value",function(e){e.forEach(function(e){var t=(e.key(),e.val());o.POST==t.Postnum&&r.ref().child("Topics").child(t.pushKey).child("Views").child(x.uid).set({Views:!0})})}),r.ref().child("Topics").once("value",function(e){e.forEach(function(e){var c=(e.key(),e.val());o.POST==c.Postnum&&r.ref().child("Topics").child(c.pushKey).child("Views").on("value",function(e){t.countViews=e.numChildren()})})}),t.votedAlready=function(){return"Voted"==T()?!1:!0},t.upVote=function(){r.ref().child("Topics").once("value",function(e){e.forEach(function(e){var t=(e.key(),e.val());o.POST==t.Postnum&&r.ref().child("Topics").child(t.pushKey).child("Vote").child(x.uid).set({Vote:1})})});var e=document.getElementById("upVoteIcon");e.classList.remove("thumb-icon"),e.classList.add("upvote");var t=document.getElementById("downVoteIcon");t.classList.remove("downvote"),t.classList.add("thumb-icon")},t.downVote=function(){r.ref().child("Topics").once("value",function(e){e.forEach(function(e){var t=(e.key(),e.val());o.POST==t.Postnum&&r.ref().child("Topics").child(t.pushKey).child("Vote").child(x.uid).set({Vote:-1})})});var e=document.getElementById("downVoteIcon");e.classList.remove("thumb-icon"),e.classList.add("downvote");var t=document.getElementById("upVoteIcon");t.classList.remove("upvote"),t.classList.add("thumb-icon")},t.countVote=0,t.votesViewing=f(r.ref().child("Topics")),r.ref().child("Topics").on("value",function(e){t.countVote=0,e.forEach(function(e){var c=(e.key(),e.val());o.POST==c.Postnum&&r.ref().child("Topics").child(c.pushKey).child("Vote").on("value",function(e){e.forEach(function(e){e.forEach(function(e){var o=(e.key(),e.val());t.countVote+=o})})})})}),t.replies=f(r.ref().child("Replies").child(t.creatorUsername+o.POST)),t.tagsTopic=f(r.ref().child("Topics")),t.tagsTopic.$loaded(function(e){e.forEach(function(e){e.Postnum==o.POST&&(t.tagsTopicRep=e.Tags)})}),t.goToProfile=function(o,r){return r?(p.setUserInfo(o),p.ACTUALsetUserInfo(t.actualReplyUser),s.show({controller:"otherUserProfileCtrl",templateUrl:"views/otherUserProfile.html",parent:e.element(document.body),resolve:{currentAuth:["refService",function(e){return e.refAuth().$requireAuth()}]},targetEvent:r,clickOutsideToClose:!0},s.alert().openFrom({top:-50,width:30,height:80}).closeTo({left:1500})),void 0):null},t.editReply=function(t,r){return t?(c.setInfo(r.pushKey,o.USERNAME,o.POST,x.uid),void s.show({controller:"editReplyCtrl",templateUrl:"views/editReply.html",parent:e.element(document.body),resolve:{currentAuth:["refService",function(e){return e.refAuth().$requireAuth()}]},targetEvent:t,clickOutsideToClose:!0},s.alert().openFrom({top:-50,width:30,height:80}).closeTo({left:1500}))):null},t.editValue=function(r){if(!r)return null;m.setDateCreated(o.DATE);var c=(a("sm")||a("xs"))&&t.customFullscreen;s.show({controller:"editTopicCtrl",templateUrl:"views/editTopic.html",parent:e.element(document.body),resolve:{currentAuth:["refService",function(e){return e.refAuth().$requireAuth()}]},targetEvent:r,clickOutsideToClose:!0,fullscreen:c}).then(function(e){},function(){})},t.deletePost=function(e){alertify.confirm("Are you sure you want to delete your reply?",function(){r.ref().child("Replies").child(o.USERNAME+o.POST).child(e.pushKey).remove(function(e){e?alertify.error("Deleting Failed : "+e):alertify.success("Sucessfully Deleted!")})},function(){alertify.warn("Canceled")})},t.urlSHARINGCURRENT="https://ng-fourm-amanuel2.c9users.io/index.html#/authHome/topic/"+o.POST+"/"+o.USERNAME,t.openShareMenu=function(e,t){e(t)},t.funcCheckEDIT=function(e){return x.uid==e.replyCreatorUID?!0:!1},t.goBackTopic=function(){h.go("authHome.desc")},t.replyUserSec=function(e){return x.uid==e.replyCreatorUID?!0:!1},t.isReplyable=function(e){return x.uid==e.replyCreatorUID?!1:!0},t.isBestAnwser=function(e){return e.topicCreatorUID==e.replyCreatorUID?!1:x.uid==e.topicCreatorUID?!0:!1},t.isLikeable=function(e){return x.uid==e.replyCreatorUID?!1:!0},t.isLikeable=function(e){return x.uid==e.replyCreatorUID?!1:!0},t.isShareble=function(e){return!0},t.isFlaggable=function(e){return x.uid==e.replyCreatorUID?!1:!0},t.isBookmarkable=function(e){return t.currentAuthGet?!0:!1},t.checkBoxNot=!1,t.checkBoxYes=!1,t.checkBoxTrueCheck=i(r.ref().child("Topics")),t.checkFuncYes=function(e){return 1==y(e)?!0:(console.log(y(e)),!1)},t.checkBoxTrueCheck.$loaded(function(e){for(var r=0;r<e.length;r++)e[r].Postnum==o.POST&&(1==e[r].IsAcceptedAnwser?t.checkBoxYes=!0:t.checkBoxNot=!0)}),t.checkBoxNotNgClick=function(e){t.checkBoxYes=!0,t.checkBoxNot=!1,t.dataNot=i(r.ref().child("Topics")),t.dataNot.$loaded(function(t){for(var c=0;c<t.length;c++)t[c].Postnum==o.POST&&r.ref().child("Topics").child(t[c].pushKey).update({IsAcceptedAnwser:!0,AcceptedAnwserReplyNum:e.Replynum})})},t.bestAnwserImageIf=function(e){return"True"==k()?!0:!1},t.checkBoxNgClick=function(e){t.checkBoxYes=!1,t.checkBoxNot=!0,t.dataYes=i(r.ref().child("Topics")),t.dataYes.$loaded(function(e){for(var t=0;t<e.length;t++)e[t].Postnum==o.POST&&r.ref().child("Topics").child(e[t].pushKey).update({IsAcceptedAnwser:!1,AcceptedAnwserReplyNum:-1})})},t.likeBoxNo=!0,t.likeBoxYes=!1,t.likeBoxNoNgClick=function(e){t.likeBoxYes=!0,t.likeBoxNo=!1},t.likeBoxYesNgClick=function(e){t.likeBoxYes=!1,t.likeBoxNo=!0},t.bookmarkBoxNo=!0,t.bookmarkBoxYes=!1,t.bookmarkBoxNoNgClick=function(e){t.bookmarkBoxYes=!0,t.bookmarkBoxNo=!1},t.bookmarkBoxYesNgClick=function(e){t.bookmarkBoxYes=!1,t.bookmarkBoxNo=!0},t.replyTopic=function(r){if(d.setTopicInfo(t.creatorAvatar,t.creatorTitle,t.creatorUID,t.creatorUsername,t.creatorValue,o.DATE,t.creatorEmail,t.timeSinceCreated,t.creatorAvatar,o.POST),!r)return null;var c=(a("sm")||a("xs"))&&t.customFullscreen;u.show({controller:"newReplyCtrl",templateUrl:"views/newReply.html",parent:e.element(document.body),resolve:{currentAuth:["refService",function(e){return e.refAuth().$requireAuth()}]},targetEvent:r,clickOutsideToClose:!0,fullscreen:c}).then(function(e){},function(){})}}var o=e.module("ForumApp");o.controller("topicCtrl",["$scope","$stateParams","refService","editReplyService","dateService","$firebaseArray","timeService","$mdBottomSheet","$mdMedia","$mdDialog","replyService","$firebaseObject","$state","otherUserService","editTopicService",t])}(angular);